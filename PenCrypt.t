#!/usr/bin/perl

use warnings;
use strict;

use PenCrypt;

use Test::More qw(no_plan);

# tests for the PenCrypt class
# run as any regular perl runnable, i.e.
# perl PenCrypt.t


my %base64string_1 = (
'encoded' => "WnBtc2VmciBybXdtcyB6dyBIc2Z5bGcgeWl5IEJ5QmJwc2xpZ2xLa3dsYWZpZ2w=",
'decoded' => "Zpmsefr rmwms zw Hsfylg yiy ByBbpsliglKkwlafigl");

my %base64string_2 = (
'encoded' => "TWFuIGlzIGRpc3Rpbmd1aXNoZWQsIG5vdCBvbmx5IGJ5IGhpcyByZWFzb24sIGJ1dCBieSB0aGlzIHNpbmd1bGFyIHBhc3Npb24gZnJvbSBvdGhlciBhbmltYWxzLCB3aGljaCBpcyBhIGx1c3Qgb2YgdGhlIG1pbmQsIHRoYXQgYnkgYSBwZXJzZXZlcmFuY2Ugb2YgZGVsaWdodCBpbiB0aGUgY29udGludWVkIGFuZCBpbmRlZmF0aWdhYmxlIGdlbmVyYXRpb24gb2Yga25vd2xlZGdlLCBleGNlZWRzIHRoZSBzaG9ydCB2ZWhlbWVuY2Ugb2YgYW55IGNhcm5hbCBwbGVhc3VyZS4=",
'decoded' => "Man is distinguished, not only by his reason, but by this singular passion from other animals, which is a lust of the mind, that by a perseverance of delight in the continued and indefatigable generation of knowledge, exceeds the short vehemence of any carnal pleasure."
);

my $pen = PenCrypt->new();

ok($base64string_1{decoded}, $pen->base64decode($base64string_1{encoded}));
ok($base64string_2{decoded}, $pen->base64decode($base64string_2{encoded}));

my %rot = (
'encoded' => "Zpmsefr rmwms zw Hsfylg yiy ByBbpsliglKkwlafigl",
'decoded' => "Brought toyou by Juhani aka DaDdrunkinMmynchkin"
);

ok($rot{encoded}, $pen->rot13($rot{encoded}, 0));
ok($rot{decoded}, $pen->rot13($rot{encoded}, 2));
ok($rot{encoded}, $pen->rot13($rot{encoded}));

